<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Atividades | Sistema Acadêmico</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Orbitron:wght@600&display=swap" rel="stylesheet">

<style>
:root {
  --text: #fff;
  --dark: #000;
  --panel: #111;
  --gray: #1a1a1a;
  --border: #222;
  --accent: #ffffff;
  --radius: 12px;
  --transition: all 0.3s ease;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: 'Inter', sans-serif;
  color: var(--text);
  background-color: var(--dark);
  display: flex;
  justify-content: center;
  align-items: flex-start;
  min-height: 100vh;
  background-image:
    linear-gradient(30deg, #111111 12%, transparent 12.5%, transparent 87%, #111111 87.5%, #111111),
    linear-gradient(150deg, #111111 12%, transparent 12.5%, transparent 87%, #111111 87.5%, #111111),
    linear-gradient(30deg, #111111 12%, transparent 12.5%, transparent 87%, #111111 87.5%, #111111),
    linear-gradient(150deg, #111111 12%, transparent 12.5%, transparent 87%, #111111 87.5%, #111111),
    linear-gradient(60deg, #77777777 25%, transparent 25.5%, transparent 75%, #77777777 75%, #77777777),
    linear-gradient(60deg, #77777777 25%, transparent 25.5%, transparent 75%, #77777777 75%, #77777777);
  background-position: 0 0, 0 0, 40px 70px, 40px 70px, 0 0, 40px 70px;
  background-size: 80px 140px;
  box-shadow: inset 0 0 100px rgba(255, 255, 255, 0.05);
  padding: 40px;
}

/* === PAINEL === */
.painel {
  background: rgba(15,15,15,0.92);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  width: 100%;
  max-width: 1100px;
  padding: 40px;
  box-shadow: 0 0 25px rgba(255,255,255,0.05);
  animation: fadeIn 0.8s ease;
}
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* === TÍTULO === */
h1 {
  font-family: 'Orbitron', sans-serif;
  font-size: 1.8rem;
  letter-spacing: 1px;
  color: var(--text);
  margin-bottom: 30px;
  border-bottom: 2px solid var(--accent);
  display: inline-block;
  padding-bottom: 6px;
}

/* === FORMULÁRIO === */
.form {
  background: rgba(20,20,20,0.9);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 25px;
  margin-bottom: 30px;
}
.form label {
  display: block;
  margin-bottom: 8px;
  font-weight: 600;
  color: #ccc;
}
.form input, .form select, .form textarea {
  width: 100%;
  background: #0f0f0f;
  border: 1px solid #333;
  color: #fff;
  padding: 12px;
  border-radius: 8px;
  margin-bottom: 20px;
  font-size: 0.95rem;
  transition: var(--transition);
}
.form input:focus, .form textarea:focus, .form select:focus {
  border-color: var(--accent);
  outline: none;
  box-shadow: 0 0 8px rgba(255,255,255,0.3);
}
.form button {
  background: var(--accent);
  border: none;
  color: #000;
  padding: 12px 22px;
  font-weight: 600;
  border-radius: 8px;
  cursor: pointer;
  transition: var(--transition);
}
.form button:hover {
  background: #fdfdfd;
  transform: scale(1.03);
  box-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
}

/* === TABELA === */
.table {
  width: 100%;
  border-collapse: collapse;
  background: rgba(10,10,10,0.8);
  border-radius: var(--radius);
  overflow: hidden;
}
.table th, .table td {
  padding: 14px 16px;
  border: 1px solid var(--border);
  text-align: left;
}
.table th {
  background: rgba(25,25,25,0.95);
  color: var(--accent);
  font-weight: 600;
  text-transform: uppercase;
  font-size: 0.9rem;
}
.table tr:hover {
  background: rgba(255,255,255,0.05);
}

/* === BOTÃO VOLTAR === */
.btn-voltar {
  display: inline-block;
  margin-top: 30px;
  padding: 10px 25px;
  background: transparent;
  color: var(--text);
  text-decoration: none;
  border-radius: 6px;
  border: 1px solid var(--accent);
  transition: var(--transition);
  font-weight: 500;
}
.btn-voltar:hover {
  background: var(--accent);
  color: #000;
  box-shadow: 0 0 10px rgb(255, 255, 255);
  transform: translateY(-2px);
}
</style>
</head>

<body>
  <div class="painel">
    <h1>Atividades</h1>

    <!-- FORMULÁRIO DE CRIAÇÃO -->
    <form class="form" id="formAtividade">
      <label for="titulo">Título da Atividade:</label>
      <input type="text" id="titulo" name="titulo" placeholder="Digite o título da atividade" required>

      <label for="turma">Turma:</label>
      <select id="turma" name="turma" required>
        <option value="">Selecione uma turma</option>
      </select>

      <label for="descricao">Descrição:</label>
      <textarea id="descricao" name="descricao" rows="4" placeholder="Descreva a atividade..."></textarea>

      <button type="submit">Publicar Atividade</button>
    </form>

    <!-- LISTA DE ATIVIDADES -->
    <table class="table" id="tabelaAtividades">
      <thead>
        <tr>
          <th>Título</th>
          <th>Turma</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        <tr><td colspan="3" style="text-align:center;color:#777;">Carregando atividades...</td></tr>
      </tbody>
    </table>

    <a href="cards.html" class="btn-voltar">← Voltar</a>
  </div>

<script>
const API_URL = "http://127.0.0.1:8000/api"; // altere para o seu backend FastAPI

// === Carregar turmas ===
async function carregarTurmas() {
  try {
    const res = await fetch(`${API_URL}/turmas`);
    const turmas = await res.json();
    const select = document.getElementById('turma');
    turmas.forEach(t => {
      const opt = document.createElement('option');
      opt.value = t.nome;
      opt.textContent = t.nome;
      select.appendChild(opt);
    });
  } catch (err) {
    console.error("Erro ao carregar turmas:", err);
  }
}

// === Carregar atividades existentes ===
async function carregarAtividades() {
  try {
    const res = await fetch(`${API_URL}/atividades`);
    const atividades = await res.json();

    const tbody = document.getElementById('tabelaAtividades').querySelector('tbody');
    tbody.innerHTML = "";
    atividades.forEach(a => {
      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${a.titulo}</td><td>${a.turma}</td><td>${a.status ?? "Publicado"}</td>`;
      tbody.appendChild(tr);
    });
  } catch (err) {
    console.error("Erro ao carregar atividades:", err);
  }
}

// === Enviar nova atividade ===
document.getElementById('formAtividade').addEventListener('submit', async function(e) {
  e.preventDefault();
  const titulo = document.getElementById('titulo').value;
  const turma = document.getElementById('turma').value;
  const descricao = document.getElementById('descricao').value;

  try {
    const res = await fetch(`${API_URL}/atividades`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ titulo, turma, descricao })
    });

    if (!res.ok) throw new Error("Erro ao publicar atividade");

    alert("✅ Atividade publicada com sucesso!");
    this.reset();
    carregarAtividades();
  } catch (err) {
    alert("❌ Erro ao enviar atividade.");
    console.error(err);
  }
});

// Inicialização
carregarTurmas();
carregarAtividades();
</script>
</body>
</html>
