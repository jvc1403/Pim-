<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Turmas - CyberClass</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">

<style>
:root {
  --bg: #0d0d0d;
  --panel: rgba(20,20,20,0.95);
  --border: #2a2a2a;
  --text: #fff;
  --accent: #fff;
  --radius: 16px;
  --transition: all 0.3s ease;
}

* {margin:0; padding:0; box-sizing:border-box;}
body {
  font-family:'Poppins',sans-serif;
  color:var(--text);
  background:var(--bg);
  display:flex;
  justify-content:center;
  align-items:flex-start;
  min-height:100vh;
  padding:50px 0;
  overflow-x:hidden;
}

/* ==== Fundo Din√¢mico ==== */
.container {
  position:fixed; inset:0; z-index:0;
  background:radial-gradient(circle at 20% 30%, #1a1a1a, #0f0f0f 80%);
}
.container::after {
  content:""; position:absolute; inset:0;
  background:linear-gradient(45deg,rgba(255,255,255,0.04) 25%,transparent 25%,transparent 50%,rgba(255,255,255,0.04) 50%,rgba(255,255,255,0.04) 75%,transparent 75%,transparent);
  background-size:80px 80px;
  animation:bgMove 10s linear infinite alternate;
}
@keyframes bgMove {0%{background-position:0 0;}100%{background-position:60px 60px;}}

/* ==== Painel ==== */
.painel {
  position:relative; z-index:2;
  width:90%; max-width:1000px;
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:40px 35px;
  box-shadow:0 0 30px rgba(255,255,255,0.05);
  backdrop-filter:blur(12px);
  animation:fadeIn 0.8s ease;
}
@keyframes fadeIn {from{opacity:0;transform:translateY(15px);}to{opacity:1;transform:translateY(0);}}

/* ==== Cabe√ßalho ==== */
h2 {
  font-size:1.9rem;
  margin-bottom:25px;
  border-left:4px solid var(--accent);
  padding-left:10px;
}

/* ==== Bot√£o Principal ==== */
#btnAddTurma {
  background:transparent;
  color:var(--accent);
  font-weight:600;
  padding:10px 18px;
  border:1px solid var(--accent);
  border-radius:var(--radius);
  cursor:pointer;
  transition:var(--transition);
}
#btnAddTurma:hover {
  background:var(--accent);
  color:#000;
  transform:scale(1.05);
  box-shadow:0 0 20px rgba(255,255,255,0.3);
}

/* ==== Formul√°rio ==== */
#addTurmaForm {
  display:none;
  flex-direction:column;
  gap:12px;
  margin-top:20px;
  padding:20px;
  background:rgba(25,25,25,0.85);
  border:1px solid #2a2a2a;
  border-radius:var(--radius);
  box-shadow:inset 0 0 15px rgba(0,0,0,0.5);
}
#addTurmaForm input {
  padding:12px 14px;
  border:none;
  border-radius:var(--radius);
  background:#111;
  color:#fff;
  font-size:15px;
}
#addTurmaForm button {
  padding:12px;
  border:none;
  border-radius:var(--radius);
  background:var(--accent);
  color:#000;
  font-weight:600;
  cursor:pointer;
  transition:var(--transition);
}
#addTurmaForm button:hover {
  transform:scale(1.05);
  box-shadow:0 0 12px rgba(255,255,255,0.3);
}

/* ==== Cards ==== */
.cards-container {
  display:flex; flex-wrap:wrap; gap:20px; margin-top:25px;
}
.card-turma {
  background:linear-gradient(145deg,#1b1b1b,#101010);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:25px 20px;
  flex:1 1 calc(33% - 20px);
  min-width:250px;
  box-shadow:0 0 15px rgba(255,255,255,0.04);
  display:flex;
  flex-direction:column;
  justify-content:space-between;
  transition:var(--transition);
  overflow:hidden;
  position:relative;
}
.card-turma:hover {
  transform:translateY(-8px) scale(1.02);
  box-shadow:0 0 25px rgba(255,255,255,0.1);
}
.card-turma h3 {margin:0 0 10px 0; font-size:1.2rem;}
.card-turma p {margin:4px 0; color:#ccc; font-size:0.9rem;}
.card-turma button {
  margin-top:12px;
  border:none;
  border-radius:10px;
  background:#fff;
  color:#000;
  font-weight:600;
  padding:10px 14px;
  cursor:pointer;
  transition:var(--transition);
}
.card-turma button:hover {
  transform:scale(1.05);
  box-shadow:0 0 15px rgba(255,255,255,0.2);
}

/* ==== Alerta ==== */
.alert {
  margin-top:15px;
  background:#181818;
  border:1px solid #444;
  border-radius:var(--radius);
  padding:12px;
  color:#aaffaa;
  text-align:center;
  display:none;
}

/* ==== Voltar ==== */
.btn-voltar {
  display:inline-block;
  margin-top:30px;
  color:#ccc;
  text-decoration:underline;
  cursor:pointer;
  font-size:14px;
}
.btn-voltar:hover {color:#fff;}
</style>
</head>

<body>
<div class="container"></div>

<div class="painel">
  <h2>Turmas</h2>

  <button id="btnAddTurma">+ Nova Turma</button>

  <form id="addTurmaForm">
    <input type="text" id="nomeTurma" placeholder="Nome da Turma" required>
    <input type="text" id="professorTurma" placeholder="Professor Respons√°vel" required>
    <button type="submit">Criar Turma</button>
  </form>

  <div id="alertMsg" class="alert">‚úÖ Turma criada e alunos cadastrados!</div>

  <div class="cards-container" id="cardsContainer"></div>

  <a href="cards.html" class="btn-voltar">‚Üê Voltar</a>
</div>

<script>
const btnAdd = document.getElementById('btnAddTurma');
const formAdd = document.getElementById('addTurmaForm');
const form = document.getElementById('addTurmaForm');
const container = document.getElementById('cardsContainer');
const alertMsg = document.getElementById('alertMsg');

let contadorGlobal = 0; // contador autom√°tico de alunos

btnAdd.addEventListener('click', () => {
  formAdd.style.display = formAdd.style.display === 'flex' ? 'none' : 'flex';
});

form.addEventListener('submit', async (e) => {
  e.preventDefault();
  const nome = document.getElementById('nomeTurma').value;
  const prof = document.getElementById('professorTurma').value;

  let turmaId = Date.now();

  // Cria turma no backend
  try {
    const res = await fetch("http://127.0.0.1:8000/api/turmas", {
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify({ nome, professor: prof })
    });
    const data = await res.json();
    turmaId = data.id || turmaId;
  } catch (err) {
    console.warn("Falha ao criar turma:", err);
  }

  // Cria automaticamente 5 alunos novos (exemplo)
  const novosAlunos = [];
  for (let i = 1; i <= 5; i++) {
    contadorGlobal++;
    novosAlunos.push({
      nome: `Aluno ${contadorGlobal}`,
      turma_id: turmaId,
      nota: 0,
      presenca: 0
    });
  }

  // Envia alunos pro backend
  try {
    await fetch("http://127.0.0.1:8000/api/alunos", {
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify(novosAlunos)
    });
  } catch (err) {
    console.warn("Erro ao enviar alunos:", err);
  }

  // Adiciona visualmente a turma
  const card = document.createElement('div');
  card.classList.add('card-turma');
  card.innerHTML = `
    <h3>${nome}</h3>
    <p>üë®‚Äçüè´ ${prof}</p>
    <p>üë• ${novosAlunos.length} alunos autom√°ticos</p>
    <button onclick="window.location.href='alunos.html?turma_id=${turmaId}&turma_nome=${encodeURIComponent(nome)}'">Ver Alunos</button>
  `;
  container.appendChild(card);

  alertMsg.style.display = 'block';
  setTimeout(() => alertMsg.style.display = 'none', 2500);

  form.reset();
  form.style.display = 'none';
});
</script>
</body>
</html>
